# 社会科目入試問題分析システム - CLAUDE.md

## プロジェクト概要
このプロジェクトは、中学入試の社会科目問題を分析し、以下の観点から詳細な分析レポートを生成するシステムです。

## 主要な分析機能

### 1. 分野別分析
- **地理**: 地図、地形、気候、産業、人口、都市、農業、工業、貿易、資源、環境
- **歴史**: 各時代（縄文〜令和）、政治、経済、文化、社会、戦争、条約
- **公民**: 憲法、法律、政治、選挙、国会、内閣、裁判所、経済、国際関係

### 2. 資料活用分析
- 地図
- グラフ（折れ線、棒グラフ、円グラフ、帯グラフ）
- 年表
- 表・統計データ
- 写真・画像
- 文書資料
- その他資料

### 3. 時事問題分析
- SDGs、環境問題
- パンデミック、健康
- デジタル、AI、技術革新
- 社会問題（少子高齢化、働き方改革）
- 国際情勢
- 選挙、政治動向
- 災害、防災

### 4. 出題形式分析
- 短答式
- 選択式
- 記述式
- 穴埋め
- 正誤判定
- 組み合わせ
- その他

## ディレクトリ構造
```
social_exam_analyzer/
├── main.py                    # メインアプリケーション
├── analyze.command           # 起動スクリプト
├── modules/
│   ├── social_analyzer.py    # 社会科目分析エンジン
│   ├── social_excel_formatter.py  # Excel出力モジュール
│   └── ocr_handler.py        # PDF OCR処理
├── data/                     # データ保存ディレクトリ
└── logs/                     # ログファイル
```

## 使用方法

### 起動
```bash
./analyze.command
```
または
```bash
python3 main.py
```

### 分析手順
1. PDFファイルを選択
2. 学校名と年度を入力
3. 分析オプションを選択（デフォルトで全て有効）
4. 「分析開始」をクリック
5. 分析完了後、「Excel保存」で詳細レポートを保存

## Excel出力内容

### シート構成
1. **概要**: 分析サマリー、基本統計
2. **問題詳細**: 全問題の詳細情報
3. **分野別分析**: 地理・歴史・公民の分布
4. **資料活用分析**: 資料種別の使用状況
5. **出題形式分析**: 問題形式の分布
6. **時事問題**: 時事問題の詳細リスト

## 技術仕様

### 必要なPythonパッケージ
- tkinter (GUI)
- pandas (データ処理)
- openpyxl (Excel出力)
- 各種OCRライブラリ（Google Cloud Vision API推奨）

### 分析アルゴリズム
- パターンマッチングによる分野判定
- キーワード抽出による主題特定
- 正規表現による問題形式判定
- 時事キーワードリストによる時事問題検出

## カスタマイズ

### 分野判定パターンの追加
`modules/social_analyzer.py`の`_initialize_field_patterns()`メソッドで、新しいパターンを追加できます。

### 時事キーワードの更新
`modules/social_analyzer.py`の`_initialize_current_affairs_keywords()`メソッドで、最新の時事キーワードを追加できます。

### Excel出力のカスタマイズ
`modules/social_excel_formatter.py`で、シート構成や書式を変更できます。

## トラブルシューティング

### PDFからテキスト抽出できない場合
- OCRライブラリが正しくインストールされているか確認
- PDFが画像ベースの場合は、OCR精度を上げる必要がある

### 分析精度が低い場合
- パターンマッチングのルールを調整
- キーワードリストを更新
- 問題文の前処理を追加

## 今後の改善予定
- 機械学習による分野判定の精度向上
- 難易度推定機能の追加
- 複数年度の傾向分析機能
- グラフ描画機能の追加