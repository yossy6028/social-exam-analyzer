# 入試問題分析アプリケーション 使用ガイド

## 概要
このアプリケーションは、国語の入試問題PDFを分析し、出題傾向や出典情報を自動的に抽出してExcelデータベースに記録するシステムです。

## 新しいワークフロー

### 1. アプリケーションの起動
```bash
cd /Users/yoshiikatsuhiko/entrance_exam_analyzer
python3 run_app.py
```

### 2. 画面説明
アプリケーションが起動すると、以下の画面が表示されます：

- **学校名**: ドロップダウンから学校を選択
- **年度**: 分析する年度を入力（例：2025）
- **PDFファイル**: 「ファイルを選択」ボタンをクリックして選択
- **分析開始**: すべての情報を入力後、このボタンをクリック

### 3. 操作フロー

#### Step 1: 情報入力
1. 学校名を選択（例：開成中学校）
2. 年度を入力（例：2025）
3. 「ファイルを選択」をクリックしてPDFファイルを選択

#### Step 2: 分析開始
「分析開始」ボタンをクリックすると、Google Cloud Vision APIを使用してPDF分析が開始されます。

#### Step 3: 自動OCR処理
システムが自動的に：
1. PDFを画像に変換
2. Google Cloud Vision APIでOCR処理を実行
3. 日本語テキストを抽出

#### Step 4: 自動分析・保存
OCR完了後、アプリケーションが自動的に：
1. 抽出されたテキストを分析（大問構成、設問タイプ、出典情報）
2. Excelデータベースに保存

## データベース構造

### ファイル名
`entrance_exam_database.xlsx`

### シート構成
- 1シート = 1学校
- 各シートには複数年度のデータを時系列で保存

### 保存される情報
- 基本情報：年度、総設問数、総文字数、大問数
- 大問別情報：ジャンル、テーマ、著者、作品、設問数、文字数
- 設問タイプ別集計：記述、選択、漢字・語句、抜き出し

## トラブルシューティング

### BunkoOCRが起動しない
- BunkoOCRがインストールされているか確認
- `/Applications/bunkoOCR.app`に存在するか確認

### OCR結果が取得できない
- BunkoOCRでOCR処理が完了しているか確認
- iCloudが有効になっているか確認

### エラーが発生する
- PDFファイルが破損していないか確認
- 必要なPythonライブラリがインストールされているか確認：
  ```bash
  pip install pandas openpyxl pillow
  ```

## 注意事項
- OCR処理中はBunkoOCRを閉じないでください
- 分析には数分かかる場合があります
- 大きなPDFファイルの場合、処理時間が長くなります