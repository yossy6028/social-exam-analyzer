"""
社会科重要用語辞書
地理・歴史・公民の重要語句を管理
"""

# 地理分野の重要語句（subject_index.mdから）
GEOGRAPHY_TERMS = {
    '農業': [
        '促成栽培', '抑制栽培', '施設園芸', '水田', '畑作', '酪農', '畜産',
        '稲作', '米作り', '二期作', '二毛作', '裏作', '輪作', '休耕',
        'ビニールハウス', '温室栽培', '有機農業', '無農薬栽培',
        '専業農家', '兼業農家', '自給的農家', '商業的農業',
        '農業協同組合', 'JA', '農協', '養蚕',
        '食料自給率', '地産地消', 'フードマイレージ',
        '水田', '畑作', '果樹', '園芸農業'
    ],
    
    '工業': [
        '重化学工業', '軽工業', '先端技術産業', 'ハイテク産業',
        '製鉄', '鉄鋼業', '石油化学工業', '自動車工業', '造船業',
        '繊維工業', '食品工業', '機械工業', '電子工業', '半導体',
        '工業地帯', '工業地域', '工場', '産業の空洞化',
        '中小企業', '大企業', '工業団地', '臨海工業地域',
        '太平洋ベルト', '京浜工業地帯', '中京工業地帯', '阪神工業地帯',
        '北九州工業地帯', '京葉工業地域', '鹿島臨海工業地域'
    ],
    
    '地形・自然': [
        '平野', '盆地', '高原', '山地', '山脈', '丘陵',
        '河川', '湖', '湖沼', '海岸', '砂丘', '半島', '岬', '湾',
        '扇状地', '三角州', 'デルタ', '河岸段丘', 'リアス海岸',
        '火山', '地震', '津波', 'プレート', '活断層',
        '温帯', '亜熱帯', '亜寒帯', '季節風', 'モンスーン',
        '梅雨', '台風', '降水量', '気温', '気候'
    ],
    
    '都市・交通': [
        '政令指定都市', '中核市', '特例市', '過疎', '過密',
        '都市化', 'ドーナツ化現象', 'ニュータウン', 'ベッドタウン',
        '新幹線', '高速道路', '空港', '港湾', '鉄道',
        '首都圏', '大都市圏', '地方都市', '商業地', '住宅地',
        '都市計画', '再開発', '区画整理'
    ]
}

# 歴史分野の重要語句（subject_index.mdから）
HISTORY_TERMS = {
    '原始・古代': [
        '猿人', '原人', '新人', '旧石器', '新石器', '縄文土器', '弥生土器',
        '三内丸山', '登呂', '吉野ヶ里', '岩宿', '貝塚', '土偶', '埴輪',
        'たて穴住居', '高床倉庫', '石包丁', '打製石器', '磨製石器',
        '青銅器', '鉄器', '銅鏡', '銅剣', '銅鐸', '銅矛'
    ],
    
    '古墳・飛鳥': [
        '古墳', '前方後円墳', '大仙古墳', '飛鳥文化', '校倉造',
        '大和政権', '大王', '聖徳太子', '十七条の憲法', '冠位十二階',
        '遣隋使', '小野妹子', '蘇我氏', '物部氏', '中大兄皇子',
        '中臣鎌足', '大化の改新', '壬申の乱', '天武天皇', '持統天皇', '藤原京'
    ],
    
    '奈良': [
        '平城京', '大宝律令', '律令国家', '公地・公民', '班田収授法',
        '租・調・庸', '口分田', '三世一身の法', '墾田永年私財法',
        '国司', '郡司', '防人', '遣唐使', '天平文化', '東大寺',
        '聖武天皇', '光明皇后', '鑑真', '唐招提寺', '正倉院',
        '阿弥陀堂', '行基', '長屋王', '藤原氏', '多賀城', '大宰府', '出挙'
    ],
    
    '平安': [
        '平安京', '桓武天皇', '坂上田村麻呂', '菅原道真', '摂関政治',
        '藤原道長', '藤原頼通', '平等院鳳凰堂', '国風文化', 'ひらがな',
        '源氏物語', '紫式部', '枕草子', '清少納言', '古今和歌集',
        '大和絵', '寝殿造', '浄土信仰', '末法思想', '院政', '白河上皇',
        '後鳥羽上皇', '保元の乱', '平治の乱', '平氏', '平清盛',
        '源氏', '源頼朝', '源義経', '壇ノ浦の戦い'
    ],
    
    '鎌倉': [
        '鎌倉幕府', '征夷大将軍', '御家人', '御恩と奉公', '守護', '地頭',
        '侍所', '政所', '問注所', '執権', '北条氏', '御成敗式目',
        '承久の乱', '元寇', '文永の役', '弘安の役', '蒙古襲来絵詞',
        '六波羅探題', '臨済宗', '曹洞宗', '法然', '親鸞', '一遍', '日蓮'
    ],
    
    '室町': [
        '室町幕府', '足利尊氏', '足利義満', '足利義政', '管領', '守護大名',
        '応仁の乱', '戦国時代', '戦国大名', '下剋上', '分国法', '一揆',
        '土一揆', '一向一揆', '北山文化', '金閣', '東山文化', '銀閣',
        '雪舟', '水墨画', '書院造', '枯山水', '観阿弥', '世阿弥',
        '能', '狂言', '連歌', '茶の湯', '千利休'
    ],
    
    '安土桃山': [
        '織田信長', '豊臣秀吉', '桶狭間', '長篠', '安土城',
        '楽市・楽座', '兵農分離', '刀狩', '太閤検地', '関白',
        '明智光秀', '本能寺の変', '石田三成', '関ヶ原', '桃山文化',
        '南蛮貿易', '南蛮文化', 'キリスト教', 'ザビエル',
        '天正遣欧少年使節', 'バテレン追放令', '朝鮮出兵', '文禄・慶長',
        '狩野派', '琳派'
    ],
    
    '江戸': [
        '江戸幕府', '徳川将軍', '参勤交代', '武家諸法度', '大名統制',
        '旗本・御家人', '身分制度', '鎖国', '絵踏', '出島', '朝鮮通信使',
        '琉球王国', '正徳の治', '享保の改革', '寛政の改革', '天保の改革',
        '新井白石', '徳川吉宗', '松平定信', '水野忠邦', '田沼意次',
        '目安箱', '公事方御定書', '倹約令', '株仲間解散', '人返しの法',
        '棄捐令', '年貢', '蔵屋敷', '菱垣廻船', '樽廻船', '東廻り航路',
        '西廻り航路', '河村瑞賢', '両替商', '札差', '株仲間',
        '問屋制家内工業', '新田開発', '商品作物', '木綿', '菜種', '藍',
        '煙草', '佐渡', '石見', '別子', '足尾', '元禄文化', '化政文化',
        '井原西鶴', '松尾芭蕉', '近松門左衛門', '歌舞伎', '浮世絵',
        '菱川師宣', '写楽', '北斎', '広重', '十返舎一九', '滝沢馬琴',
        '寺子屋', '藩校', '国学', '本居宣長', '蘭学', '解体新書',
        '伊能忠敬', '沿海輿地全図', '緒方洪庵', '適塾'
    ],
    
    '明治': [
        '黒船', 'ペリー', '日米和親条約', '開国', '安政の大獄',
        '桜田門外', '尊王攘夷', '薩英戦争', '下関戦争', '薩長同盟',
        '大政奉還', '王政復古', '戊辰戦争', '五箇条の御誓文',
        '版籍奉還', '廃藩置県', '三大改革', '岩倉使節団',
        '四民平等', '学制', '徴兵令', '地租改正', '殖産興業',
        '富国強兵', '官営模範工場', '鉄道開通', '文明開化',
        '福沢諭吉', '夏目漱石', '森鷗外', '樋口一葉', '与謝野晶子',
        '正岡子規', '自由民権運動', '大日本帝国憲法', '帝国議会',
        '条約改正', '関税自主権', '日清戦争', '下関条約', '三国干渉',
        '日英同盟', '日露戦争', 'ポーツマス条約', '韓国併合'
    ],
    
    '大正': [
        '大正デモクラシー', '護憲運動', '普通選挙法', '政党内閣',
        '原敬', '米騒動', '労働運動', '社会運動', '大衆文化',
        'ラジオ', '雑誌', '白樺派', '第一次世界大戦', '関東大震災'
    ],
    
    '昭和戦前': [
        '世界恐慌', '昭和恐慌', '金融恐慌', '軍国主義', 'ファシズム',
        '五・一五事件', '二・二六事件', '国家総動員法', '大政翼賛会',
        '日中戦争', '太平洋戦争', '第二次世界大戦', '真珠湾',
        '学徒出陣', '沖縄戦', '原爆', 'ポツダム宣言', '玉音放送'
    ],
    
    '戦後・現代': [
        '占領政策', 'GHQ', '日本国憲法', '民主化', '農地改革',
        '財閥解体', '労働基本権', '男女平等', '教育基本法',
        '平和主義', '基本的人権', '55年体制', '安保条約', '沖縄返還',
        '国連加盟', '高度経済成長', '東京五輪', '大阪万博',
        '石油危機', '冷戦', '冷戦終結', 'バブル経済', '平成不況',
        '平成時代', '令和時代'
    ]
}

# 公民分野の重要語句（subject_index.mdから）
CIVICS_TERMS = {
    '憲法・人権': [
        '日本国憲法', '基本的人権', '国民主権', '平和主義',
        '憲法改正', '憲法第9条', '法の下の平等', '個人の尊重',
        '自由権', '社会権', '参政権', '請求権',
        '生存権', '教育を受ける権利', '勤労の権利',
        '表現の自由', '信教の自由', '学問の自由',
        '環境権', '知る権利', 'プライバシー', '自己決定権', '肖像権',
        '世界人権宣言', '国際人権規約', '子どもの権利条約',
        '女子差別撤廃', '人種差別撤廃'
    ],
    
    '政治': [
        '民主主義', '議会制民主主義', '三権分立', '法の支配', '立憲主義',
        '国会', '国権の最高機関', '唯一の立法機関', '衆議院', '参議院',
        '二院制', '衆議院の解散', '衆議院の優越', '法律', '予算', '条約',
        '首相指名', '国政調査権', '国会議員',
        '内閣', '内閣総理大臣', '国務大臣', '議院内閣制', '連帯責任',
        '行政権', '行政改革', '閣議',
        '裁判所', '司法権', '司法権の独立', '最高裁', '下級裁',
        '違憲審査制', '憲法の番人', '三審制', '裁判員制度',
        '地方自治', '地方公共団体', '地方議会', '首長', '二元代表制',
        '直接請求', '住民投票', '条例', '地方税', '地方交付税', '国庫支出金',
        '選挙権', '被選挙権', '普通選挙', '平等選挙', '直接選挙',
        '秘密選挙', '小選挙区', '比例代表', '政党', '政権交代', '政治参加'
    ],
    
    '経済': [
        '市場経済', '計画経済', '混合経済', '需要と供給',
        '価格', '物価', 'インフレ', 'デフレ',
        '株式会社', '株式', '証券取引所', '投資',
        '銀行', '日本銀行', '金融政策', '財政政策',
        '税金', '消費税', '所得税', '法人税',
        '社会保障', '年金', '医療保険', '介護保険'
    ],
    
    '国際': [
        '国際連合', '国連', '安全保障理事会', '総会',
        'ユネスコ', 'ユニセフ', 'WHO', 'IMF',
        '条約', '国際法', '主権', '領土',
        'ODA', '政府開発援助', 'NGO', 'NPO',
        'グローバル化', '多文化共生', '持続可能な開発',
        'SDGs', '地球温暖化', '環境問題'
    ]
}

# 時事関連キーワード（2023-2025）
CURRENT_AFFAIRS_TERMS = [
    # 環境・エネルギー
    'カーボンニュートラル', '脱炭素', '再生可能エネルギー',
    '太陽光発電', '風力発電', '原子力発電', '電力不足',
    
    # 社会問題
    '少子高齢化', '人口減少', '空き家問題', '限界集落',
    '働き方改革', '2024年問題', '2025年問題',
    'ジェンダー平等', 'LGBTQ', 'ダイバーシティ',
    
    # 技術・デジタル
    'AI', '人工知能', 'ChatGPT', 'DX', 'デジタル変革',
    'メタバース', 'NFT', '暗号資産', '仮想通貨',
    
    # 国際情勢
    'ウクライナ', 'ロシア', 'NATO', 'EU離脱',
    'イスラエル', 'パレスチナ', 'ガザ地区',
    '米中対立', '台湾問題', '北朝鮮', 'ミサイル',
    
    # 日本の政策
    '異次元の少子化対策', 'こども家庭庁', 'デジタル庁',
    'マイナンバーカード', '防衛費増額', '安全保障',
    
    # イベント
    '大阪・関西万博', '2025年万博', 'パリオリンピック',
    'G7サミット', 'G20', 'COP', '気候変動会議'
]

def extract_important_terms(text):
    """
    テキストから重要な社会科用語を抽出
    
    Args:
        text: 分析対象のテキスト
        
    Returns:
        抽出された重要用語のリスト
    """
    found_terms = []
    
    # 地理用語をチェック
    for category, terms in GEOGRAPHY_TERMS.items():
        for term in terms:
            if term in text:
                found_terms.append({
                    'term': term,
                    'field': '地理',
                    'category': category,
                    'count': text.count(term)
                })
    
    # 歴史用語をチェック
    for category, terms in HISTORY_TERMS.items():
        for term in terms:
            if term in text:
                found_terms.append({
                    'term': term,
                    'field': '歴史',
                    'category': category,
                    'count': text.count(term)
                })
    
    # 公民用語をチェック
    for category, terms in CIVICS_TERMS.items():
        for term in terms:
            if term in text:
                found_terms.append({
                    'term': term,
                    'field': '公民',
                    'category': category,
                    'count': text.count(term)
                })
    
    # 時事用語をチェック
    for term in CURRENT_AFFAIRS_TERMS:
        if term in text:
            found_terms.append({
                'term': term,
                'field': '時事',
                'category': '時事問題',
                'count': text.count(term)
            })
    
    # 重複を除去し、出現回数でソート
    unique_terms = {}
    for item in found_terms:
        key = item['term']
        if key not in unique_terms or item['count'] > unique_terms[key]['count']:
            unique_terms[key] = item
    
    return sorted(unique_terms.values(), key=lambda x: x['count'], reverse=True)

def get_themes_from_terms(terms_list, top_n=10):
    """
    抽出された用語から主要テーマを選定
    
    Args:
        terms_list: extract_important_terms()の結果
        top_n: 上位n個のテーマを返す
        
    Returns:
        主要テーマのリスト
    """
    if not terms_list:
        return []
    
    # 分野別に集計
    field_counts = {}
    category_counts = {}
    
    for term_info in terms_list:
        field = term_info['field']
        category = f"{field}_{term_info['category']}"
        
        field_counts[field] = field_counts.get(field, 0) + term_info['count']
        category_counts[category] = category_counts.get(category, 0) + term_info['count']
    
    # 上位のテーマを選定
    themes = []
    
    # 最も多い分野を特定
    if field_counts:
        main_field = max(field_counts, key=field_counts.get)
        themes.append(f"【{main_field}中心】")
    
    # カテゴリー別の上位テーマ
    sorted_categories = sorted(category_counts.items(), key=lambda x: x[1], reverse=True)
    for category, count in sorted_categories[:3]:
        field, cat_name = category.split('_', 1)
        themes.append(f"{cat_name}（{field}）")
    
    # 重要な個別用語
    important_terms = [t['term'] for t in terms_list[:min(5, len(terms_list))]]
    
    return {
        'main_themes': themes,
        'key_terms': important_terms,
        'field_distribution': field_counts,
        'all_terms': terms_list[:top_n]
    }